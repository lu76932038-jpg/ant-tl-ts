# 询价解析 2.0 重构方案 (Inquiry Parsing 2.0 Redesign)

## 1. 目标 (Goal)
重构“询价解析”功能，实现数据持久化存储、历史任务列表查看、结果随时下载以及多用户间的任务分享。

## 2. 核心功能 (Core Features)
- **数据留痕**: 上传的文件和解析结果将永久保存至数据库。
- **任务清单**: 用户拥有独立的“历史任务”页面，可查看所有过往解析记录。
- **双重下载**: 
  - **原始文件**: 下载当初上传的文件（或原始数据）。
  - **解析结果**: 下载 AI 解析后生成的标准格式 Excel。
- **任务分享**: 支持将特定解析任务分享给其他用户（“窗户”）。

## 3. 详细设计 (Detailed Design)

### 3.1 数据库设计 (Database)
**表名**: `inquiry_tasks`

| 字段名 | 类型 | 说明 |
| :--- | :--- | :--- |
| `id` | VARCHAR(36) | 主键 (UUID) |
| `user_id` | INT | 创建者 ID |
| `file_name` | VARCHAR(255) | 原始文件名 |
| `file_path` | VARCHAR(512) | **[新增]** 服务器本地存储路径 |
| `file_size` | INT | 文件大小 (字节) |
| `status` | ENUM | 状态: `pending`, `completed`, `failed` |
| `parsed_result` | JSON | AI 解析后的完整 JSON 数据 |
| `shared_with` | JSON | 被分享的用户 ID 列表 |
| `created_at` | TIMESTAMP | 创建时间 |

### 3.2 后端接口 (Backend API)
- `POST /api/inquiry/upload`: 
    - 使用 `multer` 接收文件并保存到 `server/uploads` 目录。
    - 触发 AI 解析，创建任务记录。
- `GET /api/inquiry`: 获取任务列表。
- `GET /api/inquiry/:id/download/original`: **[新增]** 下载原始文件。
- `GET /api/inquiry/:id/download/result`: **[新增]** 实时生成并下载解析后的 Excel。
- `PUT /api/inquiry/:id/share`: 更新分享权限。

### 3.3 前端页面 (Frontend)
- **历史任务页 (`InquiryHistory`)**:
    - 操作列增加两个按钮：
        1. 📥 下载原始文件
        2. 📊 下载解析报表
